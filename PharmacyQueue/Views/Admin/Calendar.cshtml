@{
    ViewData["Title"] = "Appointment Calendar";
}

<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-gradient-primary text-white py-2">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas fa-calendar-alt me-2"></i>Appointment Calendar
                        </h5>
                        <div>
                            <a asp-action="Dashboard" class="btn btn-outline-light btn-sm">
                                <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
                            </a>
                        </div>
                    </div>
                </div>
                <div class="card-body p-2">
                    <div id="calendar"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Appointment Details Modal -->
<div class="modal fade" id="appointmentModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Appointment Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-control" id="modalName" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="text" class="form-control" id="modalEmail" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">Phone</label>
                    <input type="text" class="form-control" id="modalPhone" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">Purpose</label>
                    <input type="text" class="form-control" id="modalPurpose" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">Status</label>
                    <input type="text" class="form-control" id="modalStatus" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">Queue Number</label>
                    <input type="text" class="form-control" id="modalQueueNumber" readonly>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-gradient-primary {
        background: linear-gradient(45deg, #0d6efd, #0a58ca);
    }
    
    #calendar {
        background-color: white;
        border-radius: 0.25rem;
        padding: 0.5rem;
    }
    
    /* Calendar styling */
    .fc {
        font-size: 0.875rem;
    }
    
    .fc .fc-toolbar {
        padding: 0.5rem;
        margin-bottom: 0.5rem;
    }
    
    .fc .fc-toolbar-title {
        font-size: 1.1rem;
    }
    
    .fc .fc-button {
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
    }
    
    .fc .fc-col-header-cell {
        padding: 0.5rem;
        font-size: 0.875rem;
    }
    
    .fc .fc-daygrid-day {
        padding: 0.25rem;
    }
    
    .fc .fc-daygrid-day-number {
        padding: 0.25rem;
        font-size: 0.875rem;
    }
    
    .fc .fc-event {
        padding: 0.1rem 0.25rem;
        margin: 0.1rem 0;
        font-size: 0.75rem;
        cursor: pointer;
    }
    
    /* Event status colors */
    .fc-event-waiting {
        background-color: #ffc107;
        border-color: #ffc107;
    }
    
    .fc-event-in-progress {
        background-color: #0dcaf0;
        border-color: #0dcaf0;
    }
    
    .fc-event-completed {
        background-color: #198754;
        border-color: #198754;
    }
    
    .fc-event-cancelled {
        background-color: #dc3545;
        border-color: #dc3545;
    }
    
    /* Highlight today's date */
    .fc .fc-daygrid-day.fc-day-today {
        background-color: rgba(13, 110, 253, 0.1);
    }
    
    /* Hover effects */
    .fc .fc-daygrid-day:hover {
        background-color: rgba(0, 0, 0, 0.05);
    }
    
    .fc-event:hover {
        opacity: 0.9;
    }
</style>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,dayGridWeek'
                },
                height: 'auto',
                contentHeight: 'auto',
                events: '/Admin/GetAppointments',
                eventClick: function(info) {
                    // Show appointment details in modal
                    $('#modalName').val(info.event.extendedProps.name);
                    $('#modalEmail').val(info.event.extendedProps.email);
                    $('#modalPhone').val(info.event.extendedProps.phone);
                    $('#modalPurpose').val(info.event.extendedProps.purpose);
                    $('#modalStatus').val(info.event.extendedProps.statusText);
                    $('#modalQueueNumber').val(info.event.extendedProps.queueNumber);
                    $('#appointmentModal').modal('show');
                },
                eventDidMount: function(info) {
                    var statusClass = 'fc-event-' + info.event.extendedProps.statusText.toLowerCase().replace(' ', '-');
                    info.el.classList.add(statusClass);
                },
                dateClick: function(info) {
                    // When a date is clicked, fetch appointments for that date
                    calendar.removeAllEvents();
                    calendar.addEventSource({
                        url: '/Admin/GetAppointments',
                        method: 'GET',
                        extraParams: {
                            date: info.dateStr
                        }
                    });
                }
            });
            calendar.render();
        });
    </script>
} 